## –°—Ç–≤–æ—Ä–µ–Ω–Ω—è S3 Bucket
---
S3 - –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤ —Ü—å–æ–º—É –ø—Ä–æ–µ–∫—Ç—ñ –∑–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–µ–¥—ñ–∞ —Ñ–∞–π–ª—ñ–≤ —Ç–∞ —Å—Ç–∞—Ç–∏–∫–∏, —Ü–µ –¥—É–∂–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤ –≤–∏–ø–∞–¥–∫—É —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ Heroku, —Ç–∞–∫ —è–∫ –≤—ñ–Ω –∫–æ–∂–Ω—ñ 24 –≥–æ–¥–∏–Ω–∏ –≤–∏–¥–∞–ª—è—î —É—Å—ñ –º–µ–¥—ñ–∞ —â–æ –±—É–ª–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å—Ö–æ–≤–∏—â—ñ –ø—Ä–æ–µ–∫—Ç—É

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –¥–∞–Ω–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—ñ
- –ó–±–µ—Ä—ñ–≥–∞—î —Å—Ç–∞—Ç–∏–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –∞ —Ç–∞–∫–æ–∂ –º–µ–¥—ñ–∞ —Ñ–∞–π–ª–∏(–∫–∞—Ä—Ç–∏–Ω–∫–∏, –∞—É–¥—ñ–æ —Ñ–∞–π–ª–∏)

---
## –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è

### 1 –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [aws.amazon.com](https://aws.amazon.com)
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create an AWS Account"**
3. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ–π–Ω—É —Ñ–æ—Ä–º—É:
   - Email –∞–¥—Ä–µ—Å–∞
   - –ü–∞—Ä–æ–ª—å
   - –ù–∞–∑–≤–∞ –∞–∫–∞—É–Ω—Ç–∞ AWS
4. –ü—ñ–¥—Ç–≤–µ—Ä–¥—å—Ç–µ email

### 2 –í–∏–±—ñ—Ä –ø–ª–∞–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫–∏

1. –í–∏–±–µ—Ä—ñ—Ç—å **"Basic support - Free"** –¥–ª—è –ø–æ—á–∞—Ç–∫—É
2. –ó–∞–≤–µ—Ä—à—ñ—Ç—å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é

> üí° **–í–∞–∂–ª–∏–≤–æ**: –î–ª—è –Ω–æ–≤–∏—Ö –∞–∫–∞—É–Ω—Ç—ñ–≤ AWS –Ω–∞–¥–∞—î Free Tier –Ω–∞ 12 –º—ñ—Å—è—Ü—ñ–≤!

### 3 –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ S3 –∫–æ–Ω—Å–æ–ª—ñ

1. –£–≤—ñ–π–¥—ñ—Ç—å —É [AWS Management Console](https://console.aws.amazon.com)
2. –£ –ø–æ—à—É–∫–æ–≤–æ–º—É —Ä—è–¥–∫—É –≤–≤–µ–¥—ñ—Ç—å **"S3"**
3. –í–∏–±–µ—Ä—ñ—Ç—å **"S3"** –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø–æ—à—É–∫—É

### 4 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ bucket

1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create bucket"**
2. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å –æ—Å–Ω–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
   - **Bucket name**: `your-project-media-files` (–º–∞—î –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –≥–ª–æ–±–∞–ª—å–Ω–æ)
   - **AWS Region**: –≤–∏–±–µ—Ä—ñ—Ç—å –Ω–∞–π–±–ª–∏–∂—á–∏–π —Ä–µ–≥—ñ–æ–Ω (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `us-east-1`)

### 5 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É

1. **Object Ownership**: –≤–∏–±–µ—Ä—ñ—Ç—å **"ACLs enabled"**
2. **Block Public Access settings**: 
   - –ó–Ω—ñ–º—ñ—Ç—å –ø–æ–∑–Ω–∞—á–∫—É –∑ **"Block all public access"**
   - –ü–æ—Å—Ç–∞–≤—Ç–µ –ø–æ–∑–Ω–∞—á–∫—É —É –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—ñ
3. **Bucket Versioning**: –º–æ–∂–Ω–∞ –∑–∞–ª–∏—à–∏—Ç–∏ **"Disable"**
4. **Default encryption**: –≤–∏–±–µ—Ä—ñ—Ç—å **"Amazon S3 managed keys (SSE-S3)"**

### 6 –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è

1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create bucket"**
2. Bucket –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ —ñ –≤—ñ–Ω –∑'—è–≤–∏—Ç—å—Å—è —É —Å–ø–∏—Å–∫—É

---

## üë§ –ö—Ä–æ–∫ : –°—Ç–≤–æ—Ä–µ–Ω–Ω—è IAM –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### 7 –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ IAM –∫–æ–Ω—Å–æ–ª—ñ

1. –£ AWS Console –∑–Ω–∞–π–¥—ñ—Ç—å **"IAM"** —É –ø–æ—à—É–∫–æ–≤–æ–º—É —Ä—è–¥–∫—É
2. –í–∏–±–µ—Ä—ñ—Ç—å **"IAM"**
3. –£ –ª—ñ–≤–æ–º—É –º–µ–Ω—é –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Users"**

### 8 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create user"**
2. **User name**: –≤–≤–µ–¥—ñ—Ç—å —ñ–º'—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `s3-django-user`
3. **Access type**: –≤–∏–±–µ—Ä—ñ—Ç—å **"Programmatic access"**
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Next"**

### 9 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É

1. **Set permissions**: –≤–∏–±–µ—Ä—ñ—Ç—å **"Attach policies directly"**
2. –£ –ø–æ—à—É–∫—É –∑–Ω–∞–π–¥—ñ—Ç—å —ñ –≤–∏–±–µ—Ä—ñ—Ç—å **"AmazonS3FullAccess"**
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Next"**
4. –î–æ–¥–∞–π—Ç–µ —Ç–µ–≥–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Create user"**

### 10 –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–ª—é—á—ñ–≤ –¥–æ—Å—Ç—É–ø—É

1. –ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ:
   - **Access key ID**: `AKIA...` (20 —Å–∏–º–≤–æ–ª—ñ–≤)
   - **Secret access key**: `...` (40 —Å–∏–º–≤–æ–ª—ñ–≤)
2. **–°–∫–æ–ø—ñ—é–π—Ç–µ —Ç–∞ –∑–±–µ—Ä–µ–∂—ñ—Ç—å –æ–±–∏–¥–≤–∞ –∫–ª—é—á—ñ** - —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –±—ñ–ª—å—à–µ –Ω–µ –±—É–¥–µ –ø–æ–∫–∞–∑–∞–Ω–æ!
3. –ú–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .csv —Ñ–∞–π–ª —ñ–∑ –∫–ª—é—á–∞–º–∏


### 11 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è CORS

1. –ü–æ–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ S3 –∫–æ–Ω—Å–æ–ª—ñ
2. –í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—à bucket
3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É –≤–∫–ª–∞–¥–∫—É **"Permissions"**
4. –ó–Ω–∞–π–¥—ñ—Ç—å **"Cross-origin resource sharing (CORS)"**
5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Edit"** —ñ –≤—Å—Ç–∞–≤—Ç–µ:

```json
[
    {
        "AllowedHeaders": ["*"],
        "AllowedMethods": ["GET", "PUT", "POST", "DELETE"],
        "AllowedOrigins": ["*"],
        "ExposeHeaders": []
    }
]
```

### 11 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Bucket Policy
–£ —Ä–æ–∑–¥—ñ–ª—ñ Persmission –Ω–∞—à–æ–≥–æ S3 –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ Bucket policy —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ Edit, –ø—ñ—Å–ª—è —á–æ–≥–æ –¥–æ–¥–∞—Ç–∏ —Ç–∞–∫–∏–π –∫–æ–¥ —Ç–∞ —Å–±–µ—Ä–µ–≥—Ç–∏

```bash
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::teststepbucket/*"
        }
    ]
}
```

### 12 –í—Å—Ç–∞–Ω–æ–≤–ª—é–µ–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤ **.env**
```env
    AWS_ACCESS_KEY_ID=<id –≤–∞—à–æ–≥–æ bucket>
    AWS_SECRET_ACCESS_KEY=<access key —è–∫–∏–π –±—É–≤ –æ—Ç—Ä–∏–º–∞–Ω–Ω–∏–π –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ bucket>
    AWS_STORAGE_BUCKET_NAME=<–ù–∞–∑–≤–∞ –≤–∞—à–æ–≥–æ bucket>
    AWS_S3_REGION_NAME=eu-north-1
```